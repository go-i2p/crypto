<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>go-i2p/crypto</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <nav class="nav-sidebar">
    <div class="repo-info">
      <h2>
        <a href="index.html">go-i2p/crypto</a>
      </h2>
      <div class="repo-meta">
        üìù 127 commits
         ‚Ä¢ üìú MIT License
      </div>
    </div>
    
    <ul class="nav-links">
      <li><a href="index.html" class="active">Repository Overview</a></li>
      
      
        <div class="nav-section-title">Documentation:</div>
        
          <li><a href="docs/RELEASE_NOTES.html">RELEASE NOTES</a></li>
        
          <li><a href="docs/template.html">Template</a></li>
        
      
    </ul>
    
    <div class="nav-footer">
      <a href="https://github.com/go-i2p/crypto" target="_blank">View on GitHub</a>
    </div>
  </nav>
  
  <div class="main-content">
    <header class="repo-header">
      <h1>go-i2p/crypto</h1>
      <div class="repo-description">Comprehensive cryptography library for the I2P (Invisible Internet Project) anonymous networking ecosystem, factored out from the main router imple...</div>
      
      <div class="repo-stats">
        
        <div class="repo-stat">
          <span>üìù</span> <span>127 commits</span>
        </div>
        
        
        <div class="repo-stat">
          <span>üìÖ</span> <span>Last updated: February 19, 2026</span>
        </div>
        
        
        <div class="repo-stat">
          <span>üìú</span> <span>MIT License</span>
        </div>
        
      </div>
    </header>
    
    <main>
      
      <section id="readme" class="repo-section">
        <h2>README</h2>
        <div class="readme-content">
          <h1 id="go-i2p-crypto">go-i2p/crypto</h1>

<p>Comprehensive cryptography library for the I2P (Invisible Internet Project) anonymous networking ecosystem, factored out from the main router implementation. This package provides I2P-specific cryptographic implementations including symmetric encryption, asymmetric encryption, digital signatures, and hashing functions required for privacy-preserving communications and onion routing.</p>

<hr>

<h2 id="installation">Installation</h2>

<p>Install the package using Go modules:</p>

<pre><code class="language-bash">go get github.com/go-i2p/crypto
</code></pre>

<p><strong>Requirements:</strong></p>

<ul>
<li>Go 1.24.2 or later</li>
<li>CGO_ENABLED=0 for static linking (recommended)</li>
</ul>

<hr>

<h2 id="recent-api-improvements">Recent API Improvements</h2>

<p>üéâ <strong>Version 2.0</strong> includes major API improvements based on production usage patterns:</p>

<ul>
<li>‚úÖ <strong>Concrete Key Generation</strong>: New <code>GenerateEd25519KeyPair()</code> and <code>GenerateX25519KeyPair()</code> return concrete types</li>
<li>‚úÖ <strong>ChaCha20-Poly1305 AEAD</strong>: Dedicated authenticated encryption package for I2P tunnel and garlic messages</li>
<li>‚úÖ <strong>Unified Session API</strong>: Single <code>Session</code> type manages DH, symmetric, and tag ratchets</li>
<li>‚úÖ <strong>KDF Utilities</strong>: Consistent key derivation with <code>kdf.KeyDerivation</code> for all I2P components</li>
<li>‚úÖ <strong>Better Error Handling</strong>: Standardized sentinel errors across all packages</li>
</ul>

<p>See <a href="AUDIT.md" target="_blank">AUDIT.md</a> for detailed improvement rationale.</p>

<hr>

<h2 id="usage">Usage</h2>

<h3 id="modern-key-generation-recommended">Modern Key Generation (Recommended)</h3>

<pre><code class="language-go">package main

import (
    &quot;github.com/go-i2p/crypto/ed25519&quot;
    &quot;github.com/go-i2p/crypto/curve25519&quot;
)

func main() {
    // Generate Ed25519 signing keys - returns concrete types
    sigPubKey, sigPrivKey, err := ed25519.GenerateEd25519KeyPair()
    if err != nil {
        panic(err)
    }
    defer sigPrivKey.Zero() // Securely clear private key
    
    // Generate X25519 encryption keys - returns concrete types
    encPubKey, encPrivKey, err := curve25519.GenerateX25519KeyPair()
    if err != nil {
        panic(err)
    }
    defer encPrivKey.Zero()
    
    // Use keys directly without type assertions
    signer, _ := sigPrivKey.NewSigner()
    signature, _ := signer.Sign([]byte(&quot;message&quot;))
}
</code></pre>

<h3 id="authenticated-encryption-chacha20-poly1305-aead">Authenticated Encryption (ChaCha20-Poly1305 AEAD)</h3>

<pre><code class="language-go">package main

import (
    &quot;github.com/go-i2p/crypto/chacha20poly1305&quot;
)

func main() {
    // Generate key and nonce
    key, _ := chacha20poly1305.GenerateKey()
    nonce, _ := chacha20poly1305.GenerateNonce()
    
    // Create AEAD cipher
    aead, _ := chacha20poly1305.NewAEAD(key)
    
    // Encrypt with authentication
    plaintext := []byte(&quot;Secret message&quot;)
    associatedData := []byte(&quot;public metadata&quot;)
    ciphertext, tag, _ := aead.Encrypt(plaintext, associatedData, nonce[:])
    
    // Decrypt and verify
    decrypted, err := aead.Decrypt(ciphertext, tag[:], associatedData, nonce[:])
    if err != nil {
        // Authentication failed - message was tampered with
        panic(err)
    }
}
</code></pre>

<h3 id="unified-session-management">Unified Session Management</h3>

<pre><code class="language-go">package main

import (
    &quot;github.com/go-i2p/crypto/ratchet&quot;
)

func main() {
    // After ECIES key exchange
    session, err := ratchet.NewSessionFromECIES(
        eciesSharedSecret,
        ourEphemeralPrivKey,
        theirPublicKey,
    )
    if err != nil {
        panic(err)
    }
    defer session.Zero()
    
    // Encrypt message (handles all ratchet operations)
    messageKey, sessionTag, _ := session.EncryptMessage(plaintext)
    
    // Use message key with AEAD
    aead, _ := chacha20poly1305.NewAEAD(messageKey)
    ciphertext, authTag, _ := aead.Encrypt(plaintext, sessionTag[:], nonce)
}
</code></pre>

<h3 id="consistent-key-derivation">Consistent Key Derivation</h3>

<pre><code class="language-go">package main

import (
    &quot;github.com/go-i2p/crypto/kdf&quot;
)

func main() {
    // Derive keys from root secret
    kd := kdf.NewKeyDerivation(rootSecret)
    defer kd.Zero()
    
    // Derive purpose-specific keys
    tunnelKey, _ := kd.DeriveForPurpose(kdf.PurposeTunnelEncryption)
    garlicKey, _ := kd.DeriveForPurpose(kdf.PurposeGarlicEncryption)
    
    // Or derive session keys in one call
    rootKey, symKey, tagKey, _ := kd.DeriveSessionKeys()
}
</code></pre>

<h3 id="basic-symmetric-encryption-aes">Basic Symmetric Encryption (AES)</h3>

<pre><code class="language-go">package main

import (
    &quot;github.com/go-i2p/crypto/rand&quot;
    &quot;github.com/go-i2p/crypto/aes&quot;
    &quot;github.com/go-i2p/crypto/types&quot;
)

func main() {
    // Generate key and IV
    key := make([]byte, 32) // AES-256
    iv := make([]byte, 16)  // AES block size
    rand.Read(key)
    rand.Read(iv)
    
    // Create symmetric key
    symmetricKey := &amp;aes.AESSymmetricKey{
        Key: key,
        IV:  iv,
    }
    
    // Create encrypter and decrypter
    encrypter, _ := symmetricKey.NewEncrypter()
    decrypter, _ := symmetricKey.NewDecrypter()
    
    // Encrypt data
    plaintext := []byte(&quot;Hello, I2P!&quot;)
    ciphertext, _ := encrypter.Encrypt(plaintext)
    
    // Decrypt data
    decrypted, _ := decrypter.Decrypt(ciphertext)
}
</code></pre>

<h3 id="stream-cipher-encryption-chacha20">Stream Cipher Encryption (ChaCha20)</h3>

<pre><code class="language-go">package main

import (
    &quot;github.com/go-i2p/crypto/chacha20&quot;
    &quot;github.com/go-i2p/crypto/types&quot;
)

func main() {
    // Generate ChaCha20 key
    key, _ := chacha20.GenerateKey()
    
    // Create encrypter and decrypter
    encrypter, _ := key.NewEncrypter()
    decrypter, _ := key.NewDecrypter()
    
    // Encrypt data
    plaintext := []byte(&quot;Hello, I2P!&quot;)
    ciphertext, _ := encrypter.Encrypt(plaintext)
    
    // Decrypt data
    decrypted, _ := decrypter.Decrypt(ciphertext)
}
</code></pre>

<h3 id="asymmetric-encryption-curve25519">Asymmetric Encryption (Curve25519)</h3>

<pre><code class="language-go">package main

import (
    &quot;github.com/go-i2p/crypto/curve25519&quot;
    &quot;github.com/go-i2p/crypto/types&quot;
)

func main() {
    // Generate key pair
    pubKey, privKey, _ := curve25519.GenerateKeyPair()

    // Create encrypter and decrypter
    encrypter, _ := pubKey.NewEncrypter()
    decrypter, _ := privKey.NewDecrypter()

    // Encrypt data
    plaintext := []byte(&quot;Secret message&quot;)
    ciphertext, _ := encrypter.Encrypt(plaintext)

    // Decrypt data
    decrypted, _ := decrypter.Decrypt(ciphertext)
}
</code></pre>

<h3 id="asymmetric-encryption-elgamal">Asymmetric Encryption (ElGamal)</h3>

<pre><code class="language-go">package main

import (
    &quot;github.com/go-i2p/crypto/elg&quot;
    &quot;github.com/go-i2p/crypto/types&quot;
)

func main() {
    // Generate ElGamal key pair
    pubKey, privKey, _ := elg.GenerateKeyPair()

    // Create encrypter and decrypter
    encrypter, _ := pubKey.NewEncrypter()
    decrypter, _ := privKey.NewDecrypter()

    // Encrypt data
    plaintext := []byte(&quot;Confidential message&quot;)
    ciphertext, _ := encrypter.Encrypt(plaintext)

    // Decrypt data
    decrypted, _ := decrypter.Decrypt(ciphertext)
}
</code></pre>

<h3 id="message-authentication-hmac">Message Authentication (HMAC)</h3>

<pre><code class="language-go">package main

import (
    &quot;github.com/go-i2p/crypto/rand&quot;
    &quot;github.com/go-i2p/crypto/hmac&quot;
)

func main() {
    // Generate HMAC key
    var key hmac.HMACKey
    rand.Read(key[:])

    // Data to authenticate
    data := []byte(&quot;Authenticate this message&quot;)

    // Compute HMAC-SHA256 digest
    digest := hmac.I2PHMAC(data, key)

    // Use digest for authentication or verification
}
</code></pre>

<h3 id="digital-signatures-ed25519">Digital Signatures (Ed25519)</h3>

<pre><code class="language-go">package main

import (
    &quot;github.com/go-i2p/crypto/ed25519&quot;
    &quot;github.com/go-i2p/crypto/types&quot;
)

func main() {
    // Generate signing key
    privKey, _ := ed25519.GenerateEd25519Key()
    pubKey, _ := privKey.Public()
    
    // Create signer and verifier
    signer, _ := privKey.NewSigner()
    verifier, _ := pubKey.NewVerifier()
    
    // Sign data
    data := []byte(&quot;Document to sign&quot;)
    signature, _ := signer.Sign(data)
    
    // Verify signature
    err := verifier.Verify(data, signature)
    if err == nil {
        // Signature is valid
    }
}
</code></pre>

<hr>

<h2 id="features">Features</h2>

<ul>
<li><p><strong>Symmetric Encryption</strong></p>

<ul>
<li>AES (128/192/256-bit) with CBC mode</li>
<li>ChaCha20 stream cipher</li>
<li><strong>ChaCha20-Poly1305 AEAD</strong> (authenticated encryption) ‚ú® NEW</li>
</ul></li>

<li><p><strong>Asymmetric Encryption</strong></p>

<ul>
<li>Curve25519 (X25519) key agreement</li>
<li>RSA (2048/3072/4096-bit)</li>
<li>ElGamal encryption</li>
<li><strong>ECIES-X25519-AEAD-Ratchet</strong> with unified Session API ‚ú® NEW</li>
</ul></li>

<li><p><strong>Digital Signatures</strong></p>

<ul>
<li>Ed25519 signatures</li>
<li>DSA (Digital Signature Algorithm)</li>
<li>ECDSA (P-256, P-384, P-521 curves)</li>
</ul></li>

<li><p><strong>Message Authentication</strong></p>

<ul>
<li>HMAC (Hash-based Message Authentication Code)</li>
<li>HKDF (HMAC-based Key Derivation Function)</li>
<li><strong>Unified KDF utilities</strong> for consistent key derivation ‚ú® NEW</li>
</ul></li>

<li><p><strong>Key Management</strong></p>

<ul>
<li><strong>Concrete key generation APIs</strong> (no type assertions needed) ‚ú® NEW</li>
<li>Secure memory cleanup with <code>Zero()</code> methods</li>
<li>Forward secrecy with ratcheting</li>
</ul></li>
</ul>

<hr>

<h2 id="architecture">Architecture</h2>

<p>The package follows an interface-first design with core cryptographic interfaces defined in the <code>types/</code> package:</p>

<ul>
<li><code>Encrypter</code> / <code>Decrypter</code> interfaces for encryption operations</li>
<li><code>Signer</code> / <code>Verifier</code> interfaces for signature operations</li>
<li><code>PublicEncryptionKey</code> / <code>PrivateEncryptionKey</code> for key management</li>
<li><code>SigningPublicKey</code> / <code>SigningPrivateKey</code> for signing keys</li>
</ul>

<p>Each cryptographic algorithm is implemented in its own package with consistent error handling using the <code>github.com/samber/oops</code> library.</p>

<hr>

<h2 id="testing">Testing</h2>

<p>Run the comprehensive test suite:</p>

<pre><code class="language-bash">make test
</code></pre>

<p>The test suite includes table-driven tests for all cryptographic operations, testing edge cases like empty data, exact block sizes, and large datasets.</p>

<hr>

<h2 id="license">License</h2>

<p>MIT License - see LICENSE file for details.</p>

<p>Copyright &copy; 2025 I2P For Go</p>

        </div>
      </section>
      
      
      
      <section id="contributors" class="repo-section">
        <h2>Top Contributors</h2>
        <div class="contributors-list">
          
          <div class="contributor-item">
            <!-- Use first letter as avatar if no image available -->
            <div class="contributor-avatar">
              e
            </div>
            <div class="contributor-info">
              <div class="contributor-name">
                eyedeekay
              </div>
              <div class="contributor-commits">
                127 commits
              </div>
            </div>
          </div>
          
        </div>
        <a href="https://github.com/go-i2p/crypto/graphs/contributors" target="_blank">View all contributors on GitHub ‚Üí</a>
      </section>
      
    </main>
    
    <footer class="page-footer">
      <p>Generated on 2026-02-27 15:36:39 ‚Ä¢ <a href="https://github.com/go-i2p/crypto" target="_blank">View on GitHub</a></p>
    </footer>
  </div>
</body>
</html>